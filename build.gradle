apply plugin: 'java'
apply plugin: 'eclipse'

sourceCompatibility = 1.8

jar {
    manifest {
        attributes 'Implementation-Title': 'Jetty Tests', 'Implementation-Version': 0.1
    }
}

repositories {
    mavenCentral()
}

dependencies {
    compile 'org.eclipse.jetty:jetty-server:9.3.+'
    compile 'org.eclipse.jetty:jetty-client:9.3.+'
    compile 'org.eclipse.jetty.http2:http2-server:9.3.+'
    compile 'org.eclipse.jetty.http2:http2-client:9.3.+'
    compile 'org.eclipse.jetty.http2:http2-http-client-transport:9.3.+'
}

task(server, dependsOn: 'classes', type: JavaExec) {
    main = 'test.jetty.TestServer'
    classpath = sourceSets.main.runtimeClasspath
    systemProperties System.getProperties()
}

task(client, dependsOn: 'classes', type: JavaExec) {
    main = 'test.jetty.TestClient'
    classpath = sourceSets.main.runtimeClasspath
    systemProperties System.getProperties()
}

// To update, run: ./gradlew wrapper --gradle-version X.Y.Z
wrapper {
    distributionType = Wrapper.DistributionType.ALL
}
